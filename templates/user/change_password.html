{% extends 'base.html' %}

{% block title %}修改密码 - 江南大学实验室设备管理系统{% endblock %}

{% block sidebar %}
<div class="sidebar">
    <a href="{% url 'user_home' %}">首页</a>
    <a href="{% url 'device_list' %}">设备查询</a>
    <a href="{% url 'booking_apply' %}">预约申请</a>
    <a href="{% url 'my_booking' %}">我的预约</a>
    <a href="{% url 'user_profile' %}">个人信息</a>
    {% if is_teacher %}
    <a href="{% url 'teacher_booking_approve' %}">审批我的学生</a>
    <a href="{% url 'teacher_all_student_bookings' %}">查看我的学生申请</a>
    {% endif %}
</div>
{% endblock %}

{% block content %}
<div class="card" style="width: 450px; margin: 50px auto;">
    <h2 style="text-align: center; margin-bottom: 20px;">修改登录密码</h2>
    
    <!-- 错误/成功提示 -->
    {% if messages %}
        {% for message in messages %}
            <div style="padding: 10px; margin: 15px 0; border-radius: 4px; 
                {% if message.tags == 'success' %}background-color: #d4edda; color: #155724;{% endif %}
                {% if message.tags == 'error' %}background-color: #f8d7da; color: #721c24;{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <form method="post">
        {% csrf_token %}
        <div class="form-group">
            <label>原密码</label>
            <input type="password" name="old_password" placeholder="请输入当前登录密码" required 
                style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
        </div>
        <div class="form-group" style="margin-top: 15px;">
            <label>新密码</label>
            <input type="password" name="new_password" placeholder="请输入新密码（至少6位）" required 
                style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
            <small style="color: #666; margin-top: 5px; display: block;">
                密码建议：包含字母和数字，长度不少于6位
            </small>
        </div>
        <div class="form-group" style="margin-top: 15px;">
            <label>确认新密码</label>
            <input type="password" name="confirm_password" placeholder="请再次输入新密码" required 
                style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
        </div>
        <div style="margin-top: 20px; display: flex; gap: 10px;">
            <button type="submit" class="btn btn-success" style="flex: 1;">提交修改</button>
            <a href="{% url 'user_profile' %}" class="btn btn-secondary" style="flex: 1; text-align: center; padding: 8px 0; text-decoration: none;">取消</a>
        </div>
    </form>
</div>
{% endblock %}