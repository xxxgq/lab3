# 设备管理系统

## 安装说明

### 环境要求
- Python 3.8+
- Django 5.2.9

### 安装步骤

1. 安装项目依赖：
```bash
pip install -r requirements.txt
```

2. 运行数据库迁移：
```bash
python manage.py migrate
```

3. 创建初始用户组（可选）：
```bash
python manage.py shell < init_groups.py
```

4. 启动开发服务器：
```bash
python manage.py runserver
```

**重要提示**：如果遇到报表导出功能无法使用（如提示找不到 `openpyxl` 模块），请确保已安装所有依赖：
```bash
pip install -r requirements.txt
```

## 当前进度

### 设备管理

已完成：
+ 能让设备管理员增删改查设备
+ 其他人员查看
+ 查询这个设备再特定的时间段是否有用

TODO：
+ 查询预约状态的应该再加上筛选实践，从今往后，现在只是显示全部和这个设备有关的所有订单（有空改）
+ 还有设备要的可用性检测还没有写实时的，就是到了预约表单的实践自动设置成占用不可用

### 人员维护

在之前的基础上继续完成，管理员增删改查用户信息会报错但功能可以实现，不知道你们其他人这里会不会报错

已完成：
+ 在实验室负责人里面能增删改查用户信息
+ 用户自己能改自己的密码
+ 借用人员在登录界面可以注册
+ 教师可以在个人信息界面新增、编辑、删除学生信息

TODO：
+ 用户的身份分了学生老师和外来人员，但是没有单独的写ui界面
+ 教师通过excel批量导入学生列表

### 预约表单

因为查询设备的状态要用到这个，所以我也写了一点，用户的审批流程也写了，但是没有测试

已完成：
+ 表单实例
+ 基本的增删改查
+ 教师的审批流程，外来人员的审批流程
+ 教师初审：学生发起的预约申请首站流转至其关联的指导教师进行学术/用途审核。
+ 管理员审核：教师通过后的申请或由教师/校外人员直接发起的申请，由设备管理员进行系统资源调度审核
+ 负责人终审：针对校外人员的收费类预约，由实验室负责人进行最终行政批准。

### 台账管理

已完成：
+ 自动记录所有设备操作历史（新增、修改、删除、借出、归还等）
+ 台账记录查看（包含完整的操作历史）
+ 高级筛选功能（设备编号、操作类型、日期范围、操作员）
+ Excel导出功能（支持当前筛选结果导出，日期格式正确）
+ 设备状态自动更新
+ 借出记录关联归还时间
+ 完整的测试套件（28个测试用例，覆盖所有功能）

功能说明：
- 台账为只读记录系统，自动记录所有设备相关操作
- 支持多条件筛选和分页显示
- 可导出筛选后的数据为Excel格式（.xlsx）
- 记录包含操作时间、操作人、设备状态等完整信息

测试：
- 运行所有台账测试：`python manage.py test ledger.tests`
- 详细测试说明请查看 [TESTING.md](TESTING.md)

## 其他用来调试的信息

创建了几个用来调试的账号
+ 学生：1001
+ 老师：2001
+ 外部人员：3001
+ 设备管理员：labadmin
+ 实验室负责人：manager

密码和名称一样的

<div style="text-align: right;">
    by lmz
</div>